# 后端API测试流程

## 快速开始

### 1. 启动后端服务

```bash
cd backend
npm run dev
```

服务启动后，默认运行在 `http://localhost:3000`

### 2. 打开测试页面

在浏览器中打开 `backend/test.html` 文件

### 3. 测试步骤

#### ✅ 步骤1：健康检查
- 点击"测试健康检查"按钮
- 验证服务是否正常运行

#### ✅ 步骤2：日志分析测试
1. 选择上传类型（默认：文本）
2. 输入测试日志内容：
   ```
   Error: Build failed
   Warning: Deprecated API usage
   Info: Compilation started
   ```
3. 填写文件名（默认：test.log）
4. 点击"上传并分析日志"
5. **记录返回的 `analysisId`**（后续步骤需要）

#### ✅ 步骤3：查看分析详情
1. 将步骤2获取的 `analysisId` 填入"分析ID"字段
2. 设置分页参数（可选）
3. 点击"获取详情"
4. 查看详细的错误分析结果

#### ✅ 步骤4：规则管理测试

**4.1 获取规则列表**
- 点击"获取规则列表"
- 查看现有规则

**4.2 创建规则**
1. 填写规则信息：
   - 规则名称：测试规则
   - 正则表达式：`error.*`
   - 关键词：`["error"]`
   - 严重程度：ERROR
   - 权重：50
2. 点击"创建规则"
3. **记录返回的规则ID**（后续步骤需要）

**4.3 获取单个规则**
- 填入规则ID
- 点击"获取规则"

**4.4 更新规则**
- 填入规则ID和新名称
- 点击"更新规则"

**4.5 删除规则**
- 填入规则ID
- 点击"删除规则"（会弹出确认）

## 测试检查清单

- [x] 健康检查返回 `status: "ok"`
- [x] 日志分析成功返回 `analysisId`
- [x] 分析详情包含错误列表
- [x] 规则列表可以正常获取
- [x] 创建规则成功并返回规则ID
- [x] 可以获取单个规则详情
- [x] 规则更新成功
- [x] 规则删除成功

## 常见问题

**Q: 测试页面无法连接后端？**
- 确认后端服务已启动（`npm run dev`）
- 检查 `backend/test.html` 中的API地址是否正确
- 确认端口号是否为 3000

**Q: 分析日志返回错误？**
- 检查日志内容格式是否正确
- 确认元数据JSON格式有效
- 查看浏览器控制台的错误信息

**Q: 规则操作失败？**
- 确认规则ID是否正确
- 检查必填字段是否都已填写
- 查看响应中的错误信息

## 提示

- 所有API响应都会显示在页面上，包括状态码和完整数据
- 成功响应显示绿色边框，错误显示红色边框
- 部分操作会自动填充相关ID，方便后续测试
- 建议按顺序测试，因为后续步骤依赖前面的结果

